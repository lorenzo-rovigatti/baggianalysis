

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Baggianalysis &mdash; baggianalysis 0.5.1.dev30+g517a0d3 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> baggianalysis
          

          
          </a>

          
            
            
              <div class="version">
                0.5.1.dev30+g517a0d3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#install-with-pip">Install with <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#manual-install">Manual install</a><ul>
<li class="toctree-l3"><a class="reference internal" href="install.html#cmake-options">cmake options</a></li>
<li class="toctree-l3"><a class="reference internal" href="install.html#common-compilation-issues">Common compilation issues</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="install.html#test-suite">Test suite</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="core/core.html">The core module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core/particles.html">Particle-related classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/topology.html">Topology-related classes and utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/parsers.html">Configuration parsers</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/exporters.html">Configuration exporters</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/filters.html">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/trajectories.html">Trajectory classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/observables.html">Observables</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/neighbours.html">Neighbour finders</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="converters.html">The converters module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="traj.html">The traj module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">The utils module</a><ul class="simple">
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="extending/parser.html">Writing a parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending/topology.html">Writing a function to parse custom topologies</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">baggianalysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Baggianalysis</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/index.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="baggianalysis">
<h1>Baggianalysis<a class="headerlink" href="#baggianalysis" title="Permalink to this headline">¶</a></h1>
<p>Baggianalysis is a library aimed at simplifying the analysis of particle-based simulations. It makes it easy to parse, convert and analyse trajectories generated by simulation codes in an agnostic way. It is written in C++ and provides Python bindings. It is modular and can be extended from C++ and Python.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#install-with-pip">Install with <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#manual-install">Manual install</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#test-suite">Test suite</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="a-simple-example">
<h2>A simple example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<p>The following code imports the <code class="docutils literal notranslate"><span class="pre">baggianalysis</span></code> module, parses a single LAMMPS data file, initialises its topology and perform some computations:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">baggianalysis</span> <span class="k">as</span> <span class="nn">ba</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage is </span><span class="si">%s</span><span class="s2"> data_file&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># initialise a parser for LAMMPS data files with atom_style &quot;bond&quot;</span>
<span class="n">parser</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">LAMMPSDataFileParser</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">)</span>
<span class="c1"># parse the system</span>
<span class="n">system</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">make_system</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="c1"># initialise the topology from the same file</span>
<span class="n">topology</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Topology</span><span class="o">.</span><span class="n">make_topology_from_file</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ba</span><span class="o">.</span><span class="n">parse_LAMMPS_topology</span><span class="p">)</span>
<span class="c1"># apply the topology to the system</span>
<span class="n">topology</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of molecules: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">len</span><span class="p">(</span><span class="n">system</span><span class="o">.</span><span class="n">molecules</span><span class="p">()))</span>
<span class="c1"># compute the centres of mass of all the molecules and store them in a list </span>
<span class="n">coms</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">mol</span><span class="p">:</span> <span class="n">mol</span><span class="o">.</span><span class="n">com</span><span class="p">(),</span> <span class="n">system</span><span class="o">.</span><span class="n">molecules</span><span class="p">()))</span>
<span class="c1"># print the centres of mass to the &quot;coms.dat&quot; file</span>
<span class="n">np</span><span class="o">.</span><span class="n">savetxt</span><span class="p">(</span><span class="s2">&quot;coms.dat&quot;</span><span class="p">,</span> <span class="n">coms</span><span class="p">)</span>
</pre></div>
</div>
<p>The library makes it straightforward to work with whole trajectories. Here is an example where we compute the centre of mass of the first molecule of the system averaged over a whole trajectory:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">baggianalysis</span> <span class="k">as</span> <span class="nn">ba</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Usage is </span><span class="si">%s</span><span class="s2"> topology_file dir&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
	
<span class="n">parser</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">LAMMPSDataFileParser</span><span class="p">(</span><span class="s2">&quot;bond&quot;</span><span class="p">)</span>
<span class="n">trajectory</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">FullTrajectory</span><span class="p">(</span><span class="n">parser</span><span class="p">)</span>
<span class="c1"># the first parameter is the directory where the trajectory is stored</span>
<span class="c1"># the second parameter is the pattern that will be used to match the filenames</span>
<span class="c1"># the third parameter is True if we want to sort the files, False otherwise </span>
<span class="n">trajectory</span><span class="o">.</span><span class="n">initialise_from_folder</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;no_*&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">topology</span> <span class="o">=</span> <span class="n">ba</span><span class="o">.</span><span class="n">Topology</span><span class="o">.</span><span class="n">make_topology_from_file</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ba</span><span class="o">.</span><span class="n">parse_LAMMPS_topology</span><span class="p">)</span>

<span class="n">com</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">])</span>
<span class="k">for</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">trajectory</span><span class="o">.</span><span class="n">frames</span><span class="p">:</span>
    <span class="n">topology</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">system</span><span class="p">)</span>
    <span class="n">com</span> <span class="o">+=</span> <span class="n">system</span><span class="o">.</span><span class="n">molecules</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">com</span><span class="p">()</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The average COM is: </span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2"> </span><span class="si">%lf</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">com</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">trajectory</span><span class="o">.</span><span class="n">frames</span><span class="p">)))</span>
</pre></div>
</div>
<p>Note that baggianalysis provides a <a class="reference internal" href="core/trajectories.html#baggianalysis.core.LazyTrajectory" title="baggianalysis.core.LazyTrajectory"><code class="xref py py-class docutils literal notranslate"><span class="pre">LazyTrajectory</span></code></a> class that parses files one by one to avoid taking up too much memory. This can be useful when dealing with very large trajectories.</p>
</div>
<div class="section" id="features">
<h2>Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Supports parsing of Gromacs, LAMMPS and oxDNA configurations and trajectories out of the box. See <a class="reference internal" href="extending/parser.html"><span class="doc std std-doc">here</span></a> for instructions about how to write custom parsers.</p></li>
<li><p>Configurations can be pre-filtered (by excluding some particles, or modifying others). See <a class="reference internal" href="core/filters.html"><span class="doc std std-doc">here</span></a> for a list of filters.</p></li>
<li><p>Makes available some common (and less commond) observables (mean-squared displacement, radial distribution function, bond-order parameters, <em>etc.</em>). See <a class="reference internal" href="core/observables.html"><span class="doc std std-doc">here</span></a> for the complete list of observables.</p></li>
</ul>
</div>
<div class="section" id="main-classes">
<h2>Main classes<a class="headerlink" href="#main-classes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Each particle is an instance of the <a class="reference internal" href="core/particles.html#baggianalysis.core.Particle" title="baggianalysis.core.Particle"><code class="xref py py-class docutils literal notranslate"><span class="pre">Particle</span></code></a> class.</p></li>
<li><p>Simulation snapshots are stored in <a class="reference internal" href="core/particles.html#baggianalysis.core.System" title="baggianalysis.core.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> objects that have several attributes that allow to retrieve the properties of the particles they contain.</p></li>
<li><p>Multiple systems (also called <em>frames</em> in this context) can be stored in a <a class="reference internal" href="core/trajectories.html"><span class="doc std std-doc">trajectory object</span></a>.</p></li>
<li><p>The library provides a set of built-in <a class="reference internal" href="core/observables.html"><span class="doc std std-doc">observables</span></a> that can be used to analyse both single systems and whole trajectories.</p></li>
<li><p>The <a class="reference internal" href="core/topology.html#baggianalysis.core.Topology" title="baggianalysis.core.Topology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Topology</span></code></a> class can be used to manage the topology of a configuration. Topologies can be initialised in two ways:</p>
<ul>
<li><p>by hand, using the <a class="reference internal" href="core/topology.html#baggianalysis.core.Topology.make_empty_topology" title="baggianalysis.core.Topology.make_empty_topology"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_empty_topology()</span></code></a> static method to create a new topology and then adding bonds one after the other with the <a class="reference internal" href="core/topology.html#baggianalysis.core.Topology.add_bond" title="baggianalysis.core.Topology.add_bond"><code class="xref py py-class docutils literal notranslate"><span class="pre">add_bond</span></code></a> method</p></li>
<li><p>by using an helper function to parse the topology out of a file through the <a class="reference internal" href="core/topology.html#baggianalysis.core.Topology.make_topology_from_file" title="baggianalysis.core.Topology.make_topology_from_file"><code class="xref py py-meth docutils literal notranslate"><span class="pre">make_topology_from_file()</span></code></a> static method. Baggianalysis comes with some <a class="reference internal" href="core/topology.html"><span class="doc std std-doc">ready-made</span></a> functions that can be used to parse topologies.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="library-api">
<h2>Library API<a class="headerlink" href="#library-api" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="core/core.html">The core module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core/particles.html">Particle-related classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/topology.html">Topology-related classes and utility functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/parsers.html">Configuration parsers</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/exporters.html">Configuration exporters</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/filters.html">Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/trajectories.html">Trajectory classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/observables.html">Observables</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/neighbours.html">Neighbour finders</a></li>
<li class="toctree-l2"><a class="reference internal" href="core/utils.html">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="converters.html">The converters module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="traj.html">The traj module</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">The utils module</a><ul class="simple">
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="extending-baggianalysis">
<h2>Extending baggianalysis<a class="headerlink" href="#extending-baggianalysis" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="extending/parser.html">Writing a parser</a></li>
<li class="toctree-l1"><a class="reference internal" href="extending/topology.html">Writing a function to parse custom topologies</a></li>
</ul>
</div>
</div>
<div class="section" id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>By default, the core library is compiled dynamically. However, if Python bindings are enabled, the core library is compiled statically.</p></li>
<li><p>The timestep associated to a configuration <strong>must</strong> be an integer number. If your preferred format stores it as a floating-precision number, your parser will have to find a way of converting that to an integer. This is <em>by design</em>, as the time of a configuration is used as a key in several maps around the code, and floating-point numbers are not good at that. Moreover, integer numbers can be stored without losing any precision, in contrast to floats.</p></li>
<li><p>Normal trajectories need not load all the frames at once. Trajectories that do are called “full trajectories”. Many observables, in general, do not require access to all frames at once, which means that frames can parsed (and hence loaded) one by one when needed (lazy loading). This allows to work on big trajectories without consuming up too much memory.</p></li>
<li><p>Lists of 3D vectors are copied when accessed from the Python’s side. This means that their c++ counterparts (which are <code class="docutils literal notranslate"><span class="pre">std::vector</span></code>s) are not modified when <code class="docutils literal notranslate"><span class="pre">append</span></code> or similar Python methods are used.</p></li>
<li><p>Simple Python parsers can be used to either parse single <code class="docutils literal notranslate"><span class="pre">System</span></code>s or to initialise trajectories from file lists and folders only. In order to do so, parsers should inherit from <code class="docutils literal notranslate"><span class="pre">BaseParser</span></code> and override the <code class="docutils literal notranslate"><span class="pre">parse_file</span></code> method, which takes a string as its only argument.</p></li>
<li><p>Molecules built by the <code class="docutils literal notranslate"><span class="pre">Topology</span></code> class are named <code class="docutils literal notranslate"><span class="pre">mol_XXX</span></code>, where <code class="docutils literal notranslate"><span class="pre">XXX</span></code> is an index that runs from zero to the number of molecules minus one.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="install.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Lorenzo Rovigatti

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>